<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.fdproject.mapper.DiseaseMapper">

	<select id ="selectDiseaseList" resultType="DiseaseDTO">		 			
		SELECT DISTINCT d.disease_field		
		FROM  diseases d, recipes r
		WHERE d.disease_field = r.disease_field							
	</select>	
	
    <resultMap id="disease" type="DiseaseDTO">
        <result property="diseaseNo" column="disease_no"/>
        <result property="diseaseField" column="disease_field"/>
        <result property="diseaseName" column="disease_name"/>
        <result property="description" column="description"/>
        <result property="symptom" column="symptom"/>
    </resultMap>
    

    <sql id="diseaseColumns">
        <![CDATA[
        d.DISEASE_NO,
        d.DISEASE_FIELD,
        d.DISEASE_NAME,
        d.DESCRIPTION,
        d.SYMPTOM
        ]]>
    </sql>
    
    <sql id = "UserDiseaseColumns">
    	<![CDATA[
        u.user_disease_no,
        u.disease_no,
        u.user_id
        ]]>
    </sql>
    
    <select id="getUserDisease" parameterType="UserDiseaseDTO" resultType="String">
        select
        disease_no as diseaseNo
        from USER_DISEASES
        where USER_ID = #{userId}
    </select>
    

    <select id="diseaseList" parameterType="DiseaseDTO" resultMap="disease">
        select
        <include refid="diseaseColumns"/>
      	FROM DISEASES d
		WHERE d.disease_no = any(${cart})
    </select>

    <select id="joinDiseaseList" resultMap="disease">
   	 	<![CDATA[
	        SELECT DISEASE_NO, DISEASE_NAME
	        FROM DISEASES
	        WHERE 1=1
	        ORDER BY DISEASE_NO
        ]]>
    </select>
    
    <select id= "selectUserDiseaseList" resultType="DiseaseDTO" parameterType="String">
    	select d.disease_name    	
    	from user_Diseases ud, diseases d 
    	where ud.user_id = #{userId} and 
        	  d.disease_no = ud.disease_no     	
    </select>
    
    
    
</mapper>